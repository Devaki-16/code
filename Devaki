import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.core.type.TypeReference;
import org.springframework.stereotype.Service;

import java.io.InputStream;
import java.util.List;
import java.util.stream.Collectors;

@Service
public class JsonReaderService {

    public List<EntityData> readEntityData() {
        try {
            ObjectMapper mapper = new ObjectMapper();
            InputStream is = getClass().getClassLoader().getResourceAsStream("data.json");

            ResultWrapper resultWrapper = mapper.readValue(is, ResultWrapper.class);

            return resultWrapper.getResults().stream()
                    .map(Result::getEntity)
                    .collect(Collectors.toList());

        } catch (Exception e) {
            e.printStackTrace();
        }
        return null;
    }
}






@Override
public void run(String... args) {
    List<EntityData> dataList = service.readEntityData();
    dataList.forEach(data -> {
        System.out.println("--- Entity Data ---");

        Identifiers id = data.getIdentifiers();
        BusinessGroup bg = data.getBusinessGroup();

        System.out.println("PTY ID: " + id.getPtyId());
        System.out.println("CRDS Code: " + id.getCrdsCode());
        System.out.println("KYC ID: " + id.getKycId());

        System.out.println("\nBusiness Group Code: " + bg.getBusinessGroupCode());
        System.out.println("Name: " + bg.getName());
        System.out.println("Business Country: " + bg.getBusinessCountry());
        System.out.println("Responsible Entity Code: " + bg.getResponsibleEntityCode());
        System.out.println("Responsible Entity Name: " + bg.getResponsibleEntityName());
        System.out.println("Coverage: " + bg.getCoverage());
        System.out.println("Last Rating Date: " + bg.getLastRatingDate());

        System.out.println("------------------------------------\n");
    });
}
