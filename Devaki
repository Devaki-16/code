' Scenario4.qfl
Function ModifyOrderFromFile(filePath, newName, newClass)
    Dim fso, file, orderNum
    Set fso = CreateObject("Scripting.FileSystemObject")
    If Not fso.FileExists(filePath) Then
        Reporter.ReportEvent micFail, "Read Order Number", "File not found: " & filePath
        ModifyOrderFromFile = False
        Exit Function
    End If

    Set file = fso.OpenTextFile(filePath, 1)
    orderNum = file.ReadLine
    file.Close

    ' Open order
    Window("Flight Reservation").WinMenu("Menu").Select "File;Open Order"
    Window("Flight Reservation").WinEdit("Order No:").Set orderNum
    Window("Flight Reservation").WinButton("OK").Click

    ' Get current values
    Dim currentName, currentClass, updateBtn
    currentName = Window("Flight Reservation").WinEdit("Name:").GetROProperty("text")
    currentClass = Window("Flight Reservation").WinComboBox("Class:").GetROProperty("text")

    ' Update only if changed
    If currentName <> newName Then Window("Flight Reservation").WinEdit("Name:").Set newName
    If currentClass <> newClass Then Window("Flight Reservation").WinComboBox("Class:").Select newClass

    Set updateBtn = Window("Flight Reservation").WinButton("Update Order")

    If (currentName <> newName Or currentClass <> newClass) And updateBtn.GetROProperty("enabled") Then
        updateBtn.Click
        Reporter.ReportEvent micPass, "Scenario 4", "Order updated successfully."
        ModifyOrderFromFile = True
    Else
        Reporter.ReportEvent micWarning, "Scenario 4", "No changes to update or update button disabled."
        ModifyOrderFromFile = False
    End If
End Function
